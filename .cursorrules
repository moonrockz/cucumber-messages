# Cursor Rules for moonrockz/cucumber-messages

## Quick Reference

- **Language:** MoonBit (functional, ADT-based)
- **Build system:** mise (file-based tasks in `mise-tasks/`)
- **Commits:** Conventional Commits (`type(scope): description`)
- **Full guide:** See `AGENTS.md` for design philosophy, TDD, and coding conventions

## Commit Messages

All commits MUST use Conventional Commits format:

```
type(scope): description
```

Types: `feat`, `fix`, `docs`, `refactor`, `perf`, `test`, `build`, `ci`, `chore`, `style`

Breaking changes: add `!` after type (e.g., `feat(envelope)!: change variant names`)

## Build & Test via Mise

Always use `mise run <task>` -- never raw `moon` commands:

- `mise run test:unit` -- MoonBit unit tests
- `mise run test:all` -- All tests
- `mise tasks` -- List all available tasks

## Mise Task Convention

- Tasks are file-based scripts in `mise-tasks/` -- never add inline `[tasks]` to `.mise.toml`
- New tasks: create executable script in `mise-tasks/` with `#MISE` metadata comments
- Subdirectories create namespaced tasks: `mise-tasks/release/version` = `release:version`
- GitHub workflows MUST call `mise run <task>` instead of inline shell scripts

## Versioning & Changelog

- CHANGELOG.md is auto-generated from conventional commits via `git cliff` -- never edit manually
- `mise run release:version` -- compute next version
- `mise run release:bump` -- update moon.mod.json version
- `mise run release:changelog` -- regenerate CHANGELOG.md

## Release Conventions

- Releases go to mooncakes.io (primary) and GitHub Releases
- Tags and releases are immutable -- never force-push or delete
- Release tasks: `release:pre-check`, `release:publish`, `release:credentials`
- Release workflow has 3 phases: validate -> tag -> publish
- Mooncakes publish is a HARD GATE before GitHub Release is created
- `mise run release:pre-check` validates readiness before release

## Design Philosophy

This is a functional programming project. See `AGENTS.md` for:
- Algebraic data types, immutability, pattern matching
- Strict TDD (Red-Green-Refactor)
- Unit tests with strict TDD
