#!/usr/bin/env bash
#MISE description="Generate CHANGELOG.md from conventional commits"
set -euo pipefail

# Read version from moon.mod.json without Python
if command -v jq &>/dev/null; then
  VERSION=$(jq -r '.version' moon.mod.json)
else
  VERSION=$(grep -o '"version": "[^"]*"' moon.mod.json | head -1 | cut -d'"' -f4)
fi
git cliff --tag "v${VERSION}" -o CHANGELOG.md
echo "CHANGELOG.md updated (v${VERSION})."
